# cmakegen

This script is intended for use by sample-apps developers and maintainers to update autogenerated CMakeLists.txt scripts for C and C++ demos.

# Template files

The scripts are generated from the following template files:

* `CMakeLists.txt` -- defines top-level structure of resulting file.
* `Embedded.cmake` -- is used to define CMake target for multiplatform
 (posix + embedded targets) applications.
* `Posix.cmake` -- is used to define CMake target for posix-only applications.
* `Variable.cmake` -- Template for user-specified CMake variables.

# Template variables

The template variables are prefixed with `%` delimiter.
The following variables are substituted by the generator:

* `APP_NAME` -- The name of application.
* `APP_LANG` -- `CXX` for C++ and `C` for C projects.
* `KAA_FEATURES` -- configures Kaa SDK to disable unused features (see below).
* `DEFINITIONS` -- compile-time definitions specified by user (see below).
* `VARIABLES` -- CMake variables specified by user (see below).
* `DEFINE_EXECUTABLE` -- defines CMake target
(includes and processes either `Posix.cmake` or `Embedded.cmake`).
* `APP_SOURCES` -- list of application source files.
* `APP_LIBRARIES` -- list of additional libraries the application should link to.

# Configuration

Each application the `CMakeLists.txt` should be generated for is defined in `config.yaml` file.
List of properties:

* `appname` -- The name of application. Directly maps to `%APP_NAME` template variable.
Equals to `src/kaa_demo.c` for C and `src/KaaDemo.cpp` for C++ by default.
* `language` -- List of languages (only `c` and `cpp` are supported). Maps to `%APP_LANG`.
* `features` -- List of Kaa features used in application.
Possible values: `configuration`, `notification`, `logging`, `events`.
* `path` -- The base path to application. The resulting `CMakeList.txt` will be placed in `path`/`language`/.
* `build_embedded` -- `true` if application should support compilation for embedded targets,
`false` otherwise. Not that in case of `true` the application source tree should contain the `targets` folder. (See `sample-apps/common/target`).
* `variables` -- dictionary (map) of variable and it's default value. The user can override the default value by passing it to CMake.
* `definitions` -- Almost the same as `variables` but the variable is added to compile definitions (with `add_definitions()` command)

# Usage

Specify path to the `sample-apps` root directory as a first `cmakegen.py`'s argument.
Note that `cmakegen` assumes that `config.yaml`, `CMakeLists.txt`, `Variable.cmake`, `Posix.cmake` and `Embedded.cmake` are located in the working directory.
